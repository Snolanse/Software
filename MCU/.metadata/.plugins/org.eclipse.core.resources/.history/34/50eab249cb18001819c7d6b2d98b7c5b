/*
 * main.c
 *
 *  Created on: 18 Feb 2018
 *      Author: Mikolaj Jaworski
 */

//includes ---------------------------------------------------
#include "clock_config.h"
#include "MKE02Z4.h"

#include "fsl_adc.h"
#include "fsl_common.h"
#include "fsl_gpio.h"
#include "fsl_port.h"
#include "fsl_uart.h"

//variables ---------------------------------------------------
volatile uint32_t msTicks = 0;

//functions ---------------------------------------------------
void SysTick_Handler() {
    msTicks += 1;
}

//SysTick delay function
void delay(uint32_t ms) {
    uint32_t returnTime = msTicks + ms;
    while (msTicks < returnTime) {}
}

//Initialization of GPIO port B, initialized as output.--------
void gpio_Init(void)
{

	gpio_pin_config_t port_handler = { kGPIO_DigitalOutput, 1 };
	GPIO_PinInit(kGPIO_PORTB, 0U, &port_handler);


}
//Initialization of ADC in 12-bit resolution mode with continuous conversion and assigned to pin PTA0(channel number 0)
void adc_Init(void)
{
	adc_config_t config;
	ADC_GetDefaultConfig(&config);
	config.ResolutionMode = kADC_Resolution12BitMode;
	ADC_Init(ADC, &config);
	adc_channel_config_t chan_config =
	{
		.channelNumber = 0U,
		.enableContinuousConversion = 1,
		.enableInterruptOnConversionCompleted = 1
	};
}

//Initialization of UART
void uart_Init (void)
{
	//UART0 assigned to port A1 RX, and port A3 TX in the MUX
	 void PORT_SetPinSelect(kPORT_UART0, kPORT_UART0_RXPTA2_TXPTA3);
	 uart_config_t huart;
	 UART_GetDefaultConfig(&huart);
	 UART_SetBaudRate(UART0, 9600, uint32_t srcClock_Hz);


}

//main --------------------------------------------------------
int main(void)
{
	SysTick_Handler();
	gpio_Init();
//Infinite loop------------------------------------------------
	while(1)
	{

		GPIO_PortToggle(kGPIO_PORTB, 0U);
		delay(200);

	}

}




